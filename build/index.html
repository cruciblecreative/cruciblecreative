
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen-a1ce949a.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-bccf8c07.css" rel="stylesheet" media="print" />
      <script src="javascripts/all-c5541673.js"></script>
  </head>

  <body class="index" data-languages="[&quot;javascript&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo-9fa496dd.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="javascript">javascript</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
          </li>
          <li>
            <a href="#instantiating-the-visualizer" class="toc-h1 toc-link" data-title="Instantiating the Visualizer">Instantiating the Visualizer</a>
          </li>
          <li>
            <a href="#customizer-functions" class="toc-h1 toc-link" data-title="Customizer Functions">Customizer Functions</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#change-garment" class="toc-h2 toc-link" data-title="Change Garment">Change Garment</a>
                  </li>
                  <li>
                    <a href="#change-garment-view" class="toc-h2 toc-link" data-title="Change Garment View">Change Garment View</a>
                  </li>
                  <li>
                    <a href="#change-garment-material" class="toc-h2 toc-link" data-title="Change Garment Material">Change Garment Material</a>
                  </li>
                  <li>
                    <a href="#change-garment-lining" class="toc-h2 toc-link" data-title="Change Garment Lining">Change Garment Lining</a>
                  </li>
                  <li>
                    <a href="#change-garment-customization" class="toc-h2 toc-link" data-title="Change Garment Customization">Change Garment Customization</a>
                  </li>
                  <li>
                    <a href="#take-garment-screenshots-for-checkout" class="toc-h2 toc-link" data-title="Take Garment Screenshots for checkout">Take Garment Screenshots for checkout</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#visualizer-functions" class="toc-h1 toc-link" data-title="Visualizer Functions">Visualizer Functions</a>
          </li>
          <li>
            <a href="#service-layer" class="toc-h1 toc-link" data-title="Service Layer">Service Layer</a>
          </li>
      </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>Hi Scott, Harry and Crucible Team. Here&#39;s some documentation about the service layer of the Enzo project.</p>

<p>Here is the Garment object that you have outlined.</p>

<p>To see an updating version of this code in action:
<a href="https://codepen.io/kylegriffin/pen/qBBoQGr?editors=1011">Codepen</a></p>

<p>The camera object is subject to change, now that we have access to a model.</p>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">garment</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">options</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="na">id</span><span class="p">:</span> <span class="s2">"3i2h145p9wgunvs"</span><span class="p">,</span>
            <span class="na">code</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span>
            <span class="na">display</span><span class="p">:</span> <span class="s2">"Notch 6 cm / 2 3/8 in"</span><span class="p">,</span>
            <span class="na">parent</span><span class="p">:</span> <span class="p">{</span>
                <span class="na">id</span><span class="p">:</span> <span class="s2">"23iulrbqepnw9v8sngw"</span><span class="p">,</span>
                <span class="na">code</span><span class="p">:</span> <span class="s2">"T010505"</span><span class="p">,</span>
                <span class="na">display</span><span class="p">:</span> <span class="s2">"Button"</span><span class="p">,</span>
                <span class="na">triggerId</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="na">allowedMaterials</span><span class="p">:</span> <span class="p">[</span><span class="s1">'buttons'</span><span class="p">,</span> <span class="s1">'buttons_white'</span><span class="p">,</span> <span class="s1">'buttons_red'</span><span class="p">],</span>
                <span class="na">allowedLinings</span><span class="p">:</span> <span class="p">[],</span>
                <span class="na">garment</span><span class="p">:</span> <span class="p">{</span>
                    <span class="na">id</span><span class="p">:</span> <span class="s2">"FE8BCEEPXQ"</span><span class="p">,</span>
                    <span class="na">code</span><span class="p">:</span> <span class="s2">"02"</span><span class="p">,</span>
                    <span class="na">display</span><span class="p">:</span> <span class="s2">"Jacket"</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">},</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="na">id</span><span class="p">:</span> <span class="s2">"gailuwdnsfsd"</span><span class="p">,</span>
            <span class="na">code</span><span class="p">:</span> <span class="s2">"T01020401"</span><span class="p">,</span>
            <span class="na">display</span><span class="p">:</span> <span class="s2">"Left"</span><span class="p">,</span>
            <span class="na">parent</span><span class="p">:</span> <span class="p">{</span>
                <span class="na">id</span><span class="p">:</span> <span class="s2">"4qt;rpinfp08q32rwea"</span><span class="p">,</span>
                <span class="na">code</span><span class="p">:</span> <span class="s2">"T010204"</span><span class="p">,</span>
                <span class="na">display</span><span class="p">:</span> <span class="s2">"Lapel buttonhole"</span><span class="p">,</span>
                <span class="na">triggerId</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="na">allowedMaterials</span><span class="p">:</span> <span class="p">[],</span>
                <span class="na">allowedLinings</span><span class="p">:</span> <span class="p">[],</span>
                <span class="na">garment</span><span class="p">:</span> <span class="p">{</span>
                    <span class="na">id</span><span class="p">:</span> <span class="s2">"FE8BCEEPXQ"</span><span class="p">,</span>
                    <span class="na">code</span><span class="p">:</span> <span class="s2">"02"</span><span class="p">,</span>
                    <span class="na">display</span><span class="p">:</span> <span class="s2">"Jacket"</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">},</span>
        <span class="p">},</span>
    <span class="p">],</span>
<span class="p">}</span>
</code></pre><h1 id='instantiating-the-visualizer'>Instantiating the Visualizer</h1>
<p>My understanding is that if the customizer retains settings from previous garments, then reinstantiating the viewer by selecting a new garment will preserve the previous state if the user returns to that garment.</p>

<blockquote>
<p>To initialize, use this code:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">visualizer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Visualizer</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#emersyaIframe'</span><span class="p">));</span>

<span class="kd">let</span> <span class="nx">emersyaID</span> <span class="o">=</span> <span class="nx">visualizer</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="nx">garment</span><span class="p">);</span>
</code></pre>
<blockquote>
<p>&#39;#emersyaIframe&#39; can be whatever you would prefer the id of the iframe to be.</p>
</blockquote>

<!-- <aside class="notice">
You must replace <code>meowmeowmeow</code> with your personal API key.
</aside> -->
<h1 id='customizer-functions'>Customizer Functions</h1>
<!-- changeGarment - e.g. jacket, trousers, etc.
- changeGarmentView - e.g. jacket default, jacket open/lining, jacket zoom level, etc.
- changeGarmentMaterial
- changeGarmentLining
- onClick - to respond to hotspots
- changeGarmentCustomization -->

<aside class="warning">
All of these functions are subject to change very quickly at this time. THEY WILL NOT BE CORRECT!
</aside>
<h2 id='change-garment'>Change Garment</h2>
<p>Presumably it will be a reinstantiation with a different ID. If garment state needs to at all be preserved by this service layer, let me know.</p>
<pre class="highlight javascript tab-javascript"><code>
<span class="kd">let</span> <span class="nx">emersyaID</span> <span class="o">=</span> <span class="nx">visualizer</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="nx">garment</span><span class="p">);</span>
</code></pre><h2 id='change-garment-view'>Change Garment View</h2>
<p>Some garments will have actionable points that will affect the model. An example is a suit jacket being clicked to open and reveal the inner lining.</p>

<p>The function will also call when selecting it in the customizer.</p>
<pre class="highlight javascript tab-javascript"><code>
<span class="kd">var</span> <span class="nx">garmentView</span> <span class="o">=</span> <span class="nx">visualizer</span><span class="p">.</span><span class="nx">changeGarmentView</span><span class="p">(</span><span class="nx">triggerId</span><span class="p">);</span>
</code></pre><h2 id='change-garment-material'>Change Garment Material</h2>
<p>i.e. fabric</p>
<pre class="highlight javascript tab-javascript"><code>
<span class="kd">var</span> <span class="nx">garmentMaterial</span> <span class="o">=</span> <span class="nx">visualizer</span><span class="p">.</span><span class="nx">changeGarmentMaterial</span><span class="p">(</span><span class="nx">display</span><span class="p">,</span> <span class="nx">material</span><span class="p">);</span>
</code></pre>
<blockquote>
<p>The customization and material are customizable seperately if the allowedMaterials affects the parent (e.g. button).</p>
</blockquote>
<h2 id='change-garment-lining'>Change Garment Lining</h2>
<p>Will be finished once the lining of the model is made as a customizable garment part.</p>
<pre class="highlight javascript tab-javascript"><code>
<span class="kd">var</span> <span class="nx">garmentLining</span> <span class="o">=</span> <span class="nx">visualizer</span><span class="p">.</span><span class="nx">changeGarmentLining</span><span class="p">(</span><span class="nx">display</span><span class="p">,</span> <span class="nx">lining</span><span class="p">);</span>
</code></pre><h2 id='change-garment-customization'>Change Garment Customization</h2>
<p>To change the garment&#39;s variant of the part of the garment. E.g. changing the width of the lapel.</p>

<p>This will most likely occur after the user has clicked the garment and triggered garmentView to zoom in and also reveal the options in the customizer.</p>
<pre class="highlight javascript tab-javascript"><code>
<span class="kd">var</span> <span class="nx">garmentCustomization</span> <span class="o">=</span> <span class="nx">visualizer</span><span class="p">.</span><span class="nx">changeGarmentCustomization</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
</code></pre><h2 id='take-garment-screenshots-for-checkout'>Take Garment Screenshots for checkout</h2>
<p>This function will generate 4 images from the garment (front, back, left, right), on a transparent background, and return an object of URLs.</p>
<pre class="highlight javascript tab-javascript"><code>
<span class="kd">var</span> <span class="nx">garmentScreenshots</span> <span class="o">=</span> <span class="nx">visualizer</span><span class="p">.</span><span class="nx">getGarmentScreenshots</span><span class="p">();</span>
</code></pre><h1 id='visualizer-functions'>Visualizer Functions</h1>
<p>The visualizer functions are all functions that affect the customizer. This can happen by clicking a highlighted part of the model. </p>
<h1 id='service-layer'>Service Layer</h1><pre class="highlight javascript tab-javascript"><code>
<span class="kr">class</span> <span class="nx">Visualizer</span> <span class="p">{</span>
    <span class="nx">constructor</span><span class="p">(</span><span class="nx">iframe</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">iframe</span> <span class="o">=</span> <span class="nx">iframe</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// This is just part of the visualizer and doesn't need to return anything currently.</span>

     <span class="nx">setHighlight</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">polylist</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">iframe</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">iframe</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">viewerIframe</span> <span class="o">=</span> <span class="nx">iframe</span><span class="p">.</span><span class="nx">contentWindow</span><span class="p">;</span>
        <span class="nx">viewerIframe</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">({</span>
            <span class="na">action</span><span class="p">:</span> <span class="s1">'beginTransaction'</span>
        <span class="p">},</span> <span class="s1">'*'</span><span class="p">);</span> 
        <span class="nx">viewerIframe</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">({</span>
            <span class="na">action</span><span class="p">:</span> <span class="s1">'setHighlightByName'</span><span class="p">,</span>
            <span class="na">list</span><span class="p">:</span> <span class="nx">polylist</span>
        <span class="p">},</span> <span class="s1">'*'</span><span class="p">);</span>
        <span class="nx">viewerIframe</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">({</span>
            <span class="na">action</span><span class="p">:</span> <span class="s1">'endTransaction'</span>
        <span class="p">},</span> <span class="s1">'*'</span><span class="p">);</span> 
    <span class="p">}</span> 


    <span class="cm">/* customizer functions */</span>

    <span class="nx">changeGarmentView</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">trigger</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">iframe</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">iframe</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">viewerIframe</span> <span class="o">=</span> <span class="nx">iframe</span><span class="p">.</span><span class="nx">contentWindow</span><span class="p">;</span>
        <span class="nx">viewerIframe</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">({</span>
            <span class="na">action</span><span class="p">:</span> <span class="s1">'beginTransaction'</span>
        <span class="p">},</span> <span class="s1">'*'</span><span class="p">);</span>
        <span class="nx">viewerIframe</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">({</span>
            <span class="na">action</span> <span class="p">:</span> <span class="s1">'triggerAnimation'</span><span class="p">,</span>
            <span class="na">triggerId</span> <span class="p">:</span> <span class="nx">trigger</span><span class="p">,</span>
          <span class="p">},</span><span class="s1">'*'</span><span class="p">);</span>
        <span class="nx">viewerIframe</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">({</span>
            <span class="na">action</span><span class="p">:</span> <span class="s1">'endTransaction'</span>
        <span class="p">},</span> <span class="s1">'*'</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// materialSettings is formatted like 'buttons/buttons_white'</span>
    <span class="nx">changeGarmentMaterial</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">display</span><span class="p">,</span> <span class="nx">material</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">iframe</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">iframe</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">viewerIframe</span> <span class="o">=</span> <span class="nx">iframe</span><span class="p">.</span><span class="nx">contentWindow</span><span class="p">;</span>
        <span class="nx">viewerIframe</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">({</span>
            <span class="na">action</span> <span class="p">:</span> <span class="s1">'beginTransaction'</span>
        <span class="p">},</span><span class="s1">'*'</span><span class="p">);</span>
        <span class="nx">viewerIframe</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">({</span>
            <span class="na">action</span> <span class="p">:</span> <span class="s1">'setMaterialByName'</span><span class="p">,</span>
            <span class="na">materialSettings</span> <span class="p">:</span> <span class="nx">display</span> <span class="o">+</span> <span class="s1">'/'</span> <span class="o">+</span> <span class="nx">material</span><span class="p">,</span>
        <span class="p">},</span><span class="s1">'*'</span><span class="p">);</span>
        <span class="nx">viewerIframe</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">({</span>
            <span class="na">action</span> <span class="p">:</span> <span class="s1">'endTransaction'</span>
        <span class="p">},</span><span class="s1">'*'</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">changeGarmentLining</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">display</span><span class="p">,</span> <span class="nx">lining</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">iframe</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">iframe</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">viewerIframe</span> <span class="o">=</span> <span class="nx">iframe</span><span class="p">.</span><span class="nx">contentWindow</span><span class="p">;</span>
        <span class="nx">viewerIframe</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">({</span>
            <span class="na">action</span> <span class="p">:</span> <span class="s1">'beginTransaction'</span>
        <span class="p">},</span><span class="s1">'*'</span><span class="p">);</span>
        <span class="nx">viewerIframe</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">({</span>
            <span class="na">action</span> <span class="p">:</span> <span class="s1">'setMaterialByName'</span><span class="p">,</span>
            <span class="na">materialSettings</span> <span class="p">:</span> <span class="nx">display</span> <span class="o">+</span> <span class="s1">'/'</span> <span class="o">+</span> <span class="nx">lining</span><span class="p">,</span>
        <span class="p">},</span><span class="s1">'*'</span><span class="p">);</span>
        <span class="nx">viewerIframe</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">({</span>
            <span class="na">action</span> <span class="p">:</span> <span class="s1">'endTransaction'</span>
        <span class="p">},</span><span class="s1">'*'</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// This is called when you are changing the SIZE or the QUANTITY of the garment part. Such as increasing the lapel size or the quantity of buttons.</span>
    <span class="nx">changeGarmentCustomization</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{}</span>

    <span class="nx">getGarmentScreenshots</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"triggered"</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">iframe</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">iframe</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">viewerIframe</span> <span class="o">=</span> <span class="nx">iframe</span><span class="p">.</span><span class="nx">contentWindow</span><span class="p">;</span>
        <span class="nx">viewerIframe</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">({</span>
            <span class="na">action</span> <span class="p">:</span> <span class="s1">'beginTransaction'</span>
        <span class="p">},</span><span class="s1">'*'</span><span class="p">);</span>
        <span class="nx">viewerIframe</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">({</span>
            <span class="na">action</span> <span class="p">:</span> <span class="s1">'getScreenshots'</span><span class="p">,</span>
            <span class="na">width</span> <span class="p">:</span> <span class="mi">512</span><span class="p">,</span>
            <span class="na">height</span> <span class="p">:</span> <span class="mi">512</span><span class="p">,</span>
            <span class="na">takeBackground</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="na">cameras</span> <span class="p">:</span> <span class="p">[{</span>
                <span class="c1">// front</span>
                <span class="na">position</span> <span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.9726</span><span class="p">,</span> <span class="mf">115.8661</span><span class="p">,</span> <span class="mf">166.3097</span><span class="p">],</span>
                <span class="na">target</span><span class="p">:[</span><span class="o">-</span><span class="mf">0.9726</span><span class="p">,</span> <span class="mf">115.8661</span><span class="p">,</span> <span class="mf">0.758</span><span class="p">],</span>
                <span class="na">up</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
            <span class="p">},{</span>
                <span class="c1">// back</span>
                <span class="na">position</span> <span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.9726</span><span class="p">,</span> <span class="mf">115.8661</span><span class="p">,</span> <span class="o">-</span><span class="mf">164.7936</span><span class="p">],</span>
                <span class="na">target</span><span class="p">:[</span><span class="o">-</span><span class="mf">0.9726</span><span class="p">,</span> <span class="mf">115.8661</span><span class="p">,</span> <span class="mf">0.758</span><span class="p">],</span>
                <span class="na">up</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
            <span class="p">},{</span>
                <span class="c1">// left</span>
                <span class="na">position</span> <span class="p">:</span> <span class="p">[</span><span class="mf">164.579</span><span class="p">,</span> <span class="mf">115.8661</span><span class="p">,</span> <span class="mf">0.758</span><span class="p">],</span>
                <span class="na">target</span><span class="p">:[</span><span class="o">-</span><span class="mf">0.9726</span><span class="p">,</span> <span class="mf">115.8661</span><span class="p">,</span> <span class="mf">0.758</span><span class="p">],</span>
                <span class="na">up</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> 
            <span class="p">},{</span>
                <span class="c1">// right</span>
                <span class="na">position</span> <span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">166.5243</span><span class="p">,</span> <span class="mf">115.8661</span><span class="p">,</span> <span class="mf">0.758</span><span class="p">],</span>
                <span class="na">target</span><span class="p">:[</span><span class="o">-</span><span class="mf">0.9726</span><span class="p">,</span> <span class="mf">115.8661</span><span class="p">,</span> <span class="mf">0.758</span><span class="p">],</span>
                <span class="na">up</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="p">]},</span><span class="s1">'*'</span><span class="p">);</span>
        <span class="nx">viewerIframe</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">({</span>
            <span class="na">action</span> <span class="p">:</span> <span class="s1">'endTransaction'</span>
        <span class="p">},</span><span class="s1">'*'</span><span class="p">);</span>
    <span class="p">}</span>


    <span class="nx">init</span><span class="p">(</span><span class="nx">garment</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">viewerIframe</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">viewerActive</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">iframe</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">iframe</span><span class="p">;</span>

      <span class="kd">var</span> <span class="nx">garmentID</span> <span class="o">=</span> <span class="nx">garment</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">parent</span><span class="p">.</span><span class="nx">garment</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
        <span class="nx">iframe</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="s1">'https://emersya.com/showcase/'</span> <span class="o">+</span> <span class="nx">garmentID</span><span class="p">;</span>

        <span class="nx">iframe</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="nx">viewerIframe</span> <span class="o">=</span> <span class="nx">iframe</span><span class="p">.</span><span class="nx">contentWindow</span><span class="p">;</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="s1">'message'</span><span class="p">,</span> <span class="nx">visualizerEventListener</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
            <span class="nx">viewerIframe</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">({</span>
                <span class="na">action</span><span class="p">:</span> <span class="s1">'registerCallback'</span>
            <span class="p">},</span> <span class="s1">'*'</span><span class="p">);</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'message'</span><span class="p">,</span> <span class="nx">visualizerEventListener</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
            <span class="nx">viewerIframe</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">({</span>
                <span class="na">action</span><span class="p">:</span> <span class="s1">'getViewerState'</span>
            <span class="p">},</span> <span class="s1">'*'</span><span class="p">);</span>
        <span class="p">};</span>

      <span class="kd">var</span> <span class="nx">visualizerEventListener</span> <span class="o">=</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">data</span> <span class="o">&amp;&amp;</span> <span class="nx">event</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">action</span> <span class="o">==</span> <span class="s1">'onStateChange'</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">viewerState</span> <span class="o">==</span> <span class="s1">'loaded'</span> <span class="o">||</span> <span class="nx">event</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">viewerState</span> <span class="o">==</span> <span class="s1">'fallbackloaded'</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">viewerActive</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
              <span class="k">this</span><span class="p">.</span><span class="nx">getGarmentScreenshots</span><span class="p">();</span>
            <span class="p">}</span> 
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">data</span> <span class="o">&amp;&amp;</span> <span class="nx">event</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">action</span> <span class="o">==</span> <span class="s1">'onPolylistHighlight'</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">setHighlight</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">polylistName</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">data</span> <span class="o">&amp;&amp;</span> <span class="nx">event</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">action</span> <span class="o">==</span> <span class="s1">'onPolylistSelection'</span><span class="p">)</span> <span class="p">{</span>
          <span class="c1">//  this.changeGarmentView(1);</span>
        <span class="p">}</span>  
       <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">data</span> <span class="o">&amp;&amp;</span> <span class="nx">event</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">action</span> <span class="o">==</span> <span class="s1">'onScreenshots'</span><span class="p">)</span> <span class="p">{</span>
         <span class="kd">var</span> <span class="nx">screenshots</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">screenshots</span><span class="p">;</span>
            <span class="nx">screenshots</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">screenshot</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
              <span class="c1">// console.log('&lt;img src="' + screenshot + '" /&gt;');    </span>
            <span class="p">});</span>
       <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">data</span> <span class="o">&amp;&amp;</span> <span class="nx">event</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">action</span> <span class="o">==</span> <span class="s1">'onError'</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>
        <span class="p">}</span>

    <span class="p">};</span>

        <span class="k">return</span> <span class="nx">garmentID</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">}</span>

</code></pre>
      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="javascript">javascript</a>
          </div>
      </div>
    </div>
  </body>
</html>
